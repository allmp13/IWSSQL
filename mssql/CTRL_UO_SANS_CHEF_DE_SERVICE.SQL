SELECT
    C_SERVICE,
    L_FULLNAMESERVICE
FROM
    IWSPROD.suiteisilog.SERVICE
WHERE len(C_SERVICE)=10
    AND C_SERVICE NOT IN
(SELECT
        C_SERVICE
    FROM
        IWSPROD.suiteisilog.UTILISATEUR
    WHERE C_FONCTION IN (/*'CDC','CDCSP','CDS','CDST','CDSPREV'*/'50CHC','50CHS') AND len(C_SERVICE)=10)
    AND C_SERVICE NOT IN
    (
        select H.C_SERVICE/*U.N_UTIL,H.C_FONCTION,S.N_SERVICE*/ from UTILAFFECTHAB H,UTILISATEUR U, SERVICE S
where H.D_ARCHIVE IS NULL and H.C_FONCTION like '50%' and U.C_UTIL=H.C_UTIL and H.C_SERVICE=S.C_SERVICE 
    )
    AND RIGHT(L_FULLNAMESERVICE,1) <> '-'