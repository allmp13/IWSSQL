SELECT
    F.L_FONCTION,
    U.N_UTIL,
    U.PRE_UTIL,
    S.L_FULLNAMESERVICE,
    U.C_SERVICE
FROM
    IWSPROD.suiteisilog.UTILISATEUR U INNER JOIN suiteisilog.FONCTION F ON U.C_FONCTION=F.C_FONCTION INNER JOIN suiteisilog.SERVICE S ON S.C_SERVICE=U.C_SERVICE
WHERE U.C_FONCTION IN ('20CHP') AND len(U.C_SERVICE)<>4 AND U.D_ARCHIVE IS NULL
UNION
SELECT
    F.L_FONCTION,
    U.N_UTIL,
    U.PRE_UTIL,
    S.L_FULLNAMESERVICE,
    U.C_SERVICE
FROM
    IWSPROD.suiteisilog.UTILISATEUR U INNER JOIN suiteisilog.FONCTION F ON U.C_FONCTION=F.C_FONCTION INNER JOIN suiteisilog.SERVICE S ON S.C_SERVICE=U.C_SERVICE
WHERE U.C_FONCTION IN ('40CHG','40ACG') AND len(U.C_SERVICE)<>8 AND U.D_ARCHIVE IS NULL
UNION
SELECT
    F.L_FONCTION,
    U.N_UTIL,
    U.PRE_UTIL,
    S.L_FULLNAMESERVICE,
    U.C_SERVICE
FROM
    IWSPROD.suiteisilog.UTILISATEUR U INNER JOIN suiteisilog.FONCTION F ON U.C_FONCTION=F.C_FONCTION INNER JOIN suiteisilog.SERVICE S ON S.C_SERVICE=U.C_SERVICE
WHERE U.C_FONCTION IN ('50CHC','50CHS') AND len(U.C_SERVICE)<>10 AND U.D_ARCHIVE IS NULL
UNION
SELECT
    F.L_FONCTION,
    U.N_UTIL,
    U.PRE_UTIL,
    S.L_FULLNAMESERVICE,
    U.C_SERVICE
FROM
    IWSPROD.suiteisilog.UTILISATEUR U INNER JOIN suiteisilog.FONCTION F ON U.C_FONCTION=F.C_FONCTION INNER JOIN suiteisilog.SERVICE S ON S.C_SERVICE=U.C_SERVICE
WHERE U.C_FONCTION IN ('60CHB') AND len(U.C_SERVICE)<>12 AND U.D_ARCHIVE IS NULL
